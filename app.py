import os
from flask import Flask, request, jsonify
from dotenv import load_dotenv

# ุชุญููู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุฅุฐุง ููุช ุชุณุชุฎุฏู ูุญูููุง
load_dotenv()

# ุงูุชุญูู ูู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ
OPENAI_API_KEY = os.environ.get("OPENAI_API_KEY")
GENAI_API_KEY = os.environ.get("GENAI_API_KEY")
PORT = int(os.environ.get("PORT", 5000))

if not OPENAI_API_KEY or not GENAI_API_KEY:
    raise ValueError("ูุฌุจ ุชุนููู ุฌููุน ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ูู ุฅุนุฏุงุฏุงุช Render (OPENAI_API_KEY ู GENAI_API_KEY)")

import openai
from google.generativeai import client as genai_client

# ุฅุนุฏุงุฏ ุชุทุจูู Flask
app = Flask(__name__)

# ุชููุฆุฉ ููุงุฐุฌ AI
openai.api_key = OPENAI_API_KEY
genai_client.configure(api_key=GENAI_API_KEY)

# ุฑุณุงูุฉ ุงููุณุงุนุฏุฉ
HELP_MESSAGE = """
ุฃูุงูุฑ ุงูุจูุช ุงููุชุงุญุฉ:
1. ูุณุงุนุฏุฉ โ ุนุฑุถ ูุฐู ุงูุฑุณุงูุฉ
2. ุชุนูู ุงูุฅูุฌููุฒูุฉ โ ุชุนููู ุจุทุฑููุฉ ูุนุจุฉ
3. ูุถูุถุฉ โ ุงูุชุญุฏุซ ุนู ุงููุดุงุนุฑ ูุงูุญุตูู ุนูู ุญููู
4. ุชูููุฏ ุตูุฑ โ ุฅูุดุงุก ุตูุฑ ูููุงููุง ุฃู ููุงูุน AI
5. ุชูููุฏ ููุฏูู โ ุฅูุดุงุก ููุฏูููุงุช ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
6. ูุชุงุจุฉ ููุฏ โ ูุชุงุจุฉ ูุชุตุญูุญ ุงูุฃููุงุฏ
7. ุดุฑุงุฆุญ ุนุฑุถ โ ุฅูุดุงุก ุนุฑูุถ ุชูุฏูููุฉ
8. ููุฎุต ูุงุฌุจุงุช โ ููุฎุตุงุช ูุญููู ูููุงุฌุจุงุช ุญุณุจ ุงููุงุฏุฉ ูุงูุตู
"""

@app.route("/bot", methods=["POST"])
def bot():
    data = request.json
    user_message = data.get("message", "").strip()

    # ุฃูุฑ ุงููุณุงุนุฏุฉ
    if user_message.lower() == "ูุณุงุนุฏุฉ":
        return jsonify({"reply": HELP_MESSAGE})

    # ุชุนูู ุงูุฅูุฌููุฒูุฉ ุจุทุฑููุฉ ูุนุจุฉ
    elif "ุชุนูู ุงูุฅูุฌููุฒูุฉ" in user_message:
        reply = "ููุจุฏุฃ ูุนุจุฉ ุชุนููู ุงูุฅูุฌููุฒูุฉ! ๐ฎ\nุงูุชุจ ูููุฉ ูุณุฃุนููู ูุนูุงูุง ุจุทุฑููุฉ ููุชุนุฉ."
        return jsonify({"reply": reply})

    # ูุถูุถุฉ ุงููุดุงุนุฑ
    elif "ูุถูุถุฉ" in user_message:
        reply = "ุญุฏุซูู ุนู ูุดุงุนุฑู ูุณุฃูุฏู ูู ูุตุงุฆุญ ูุญููู ุชุณุงุนุฏู ุนูู ุงูุดุนูุฑ ุงูุฃูุถู ๐"
        return jsonify({"reply": reply})

    # ุชูููุฏ ุตูุฑ
    elif "ุตูุฑุฉ" in user_message:
        # ูุซุงู: ูููู ุชูููุฏ ุฃูุฑ ูููุงููุง ุฃู AI
        prompt = user_message.replace("ุตูุฑุฉ", "").strip()
        reply = f"ุชู ุฅูุดุงุก ุตูุฑุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจูุงุกู ุนูู ุงููุตู: {prompt} ๐จ"
        return jsonify({"reply": reply})

    # ุชูููุฏ ููุฏูู
    elif "ููุฏูู" in user_message:
        prompt = user_message.replace("ููุฏูู", "").strip()
        reply = f"ุชู ุฅูุดุงุก ููุฏูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจูุงุกู ุนูู ุงููุตู: {prompt} ๐ฌ"
        return jsonify({"reply": reply})

    # ูุชุงุจุฉ ูุชุตุญูุญ ุงูุฃููุงุฏ
    elif "ููุฏ" in user_message:
        reply = "ูููููู ูุณุงุนุฏุชู ูู ูุชุงุจุฉ ุงูุฃููุงุฏ ุฃู ุชุตุญูุญูุง. ุฃุฑุณู ูู ุงูููุฏ ุงูุฐู ุชุฑูุฏ ุงูุนูู ุนููู."
        return jsonify({"reply": reply})

    # ุฅูุดุงุก ุดุฑุงุฆุญ ุนุฑุถ
    elif "ุนุฑุถ" in user_message:
        reply = "ูููููู ุฅูุดุงุก ุนุฑุถ ุชูุฏููู ูู ุจุงููุงููุง ุฃู AI. ุงุฑุณู ูู ุงูููุฑุฉ ุฃู ุงููุญุชูู."
        return jsonify({"reply": reply})

    # ููุฎุตุงุช ูุงุฌุจุงุช
    elif "ูุงุฌุจ" in user_message:
        reply = f"ุชู ุงุณุชุฎุฑุงุฌ ููุฎุต ูุญููู ูููุงุฌุจ: {user_message} ๐"
        return jsonify({"reply": reply})

    # ุฃูุงูุฑ ุฅูุดุงุก ุญุฑู ุงูุฌูู ุจุทุงุจุน ุฏูุฒูู
    elif "ุญุฑู ุงูุฌูู" in user_message:
        reply = "ุชู ุฅูุดุงุก ุฃูุฑ ุงุญุชุฑุงูู ูุชูููุฏ ุญุฑู ุงูุฌูู ุจุทุงุจุน ุฏูุฒูู ุดุงูู ูููุชุจุ ุงูุตูุฑุ ุงูููุฏููุ ูุงูุนุฑูุถ ุงูุชูุฏูููุฉ."
        return jsonify({"reply": reply})

    else:
        reply = "ุนุฐุฑุงูุ ูู ุฃููู ุงูุฃูุฑ. ุงูุชุจ 'ูุณุงุนุฏุฉ' ูุฑุคูุฉ ุฌููุน ุงูุฃูุงูุฑ ุงููุชุงุญุฉ."
        return jsonify({"reply": reply})

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=PORT)
